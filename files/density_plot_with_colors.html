<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Density Plot</title>
    <script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
</head>
<body>
    <div id="plot" style="width:100%; height:600px;"></div>
    <div style="margin: 10px 0;">
        <label for="colormap">Choose a colormap:</label>
        <select id="colormap"></select>
    </div>

    <script>
        // Load the JSON file dynamically for density data
        fetch('density_data.json')
            .then(response => response.json())
            .then(densityData => {
                const x_domain = densityData.x_domain;
                const y_domain = densityData.y_domain;
                const f_density = densityData.f_density;

                // Create the initial plot
                const initialColormap = 'batlow'; // Default scientific colormap
                Plotly.newPlot('plot', [{
                    z: f_density,
                    x: x_domain,
                    y: y_domain,
                    type: 'surface',
                    colorscale: initialColormap
                }], {
                    title: "Interactive Density Plot",
                    scene: {
                        xaxis: { title: "x", range: [Math.min(...x_domain), Math.max(...x_domain)] },
                        yaxis: { title: "y", range: [Math.min(...y_domain), Math.max(...y_domain)] },
                        zaxis: { title: "Density", range: [-1, 2] },
                        aspectmode: "cube"
                    }
                });

                // Load Crameri color scales
                fetch('cmcrameri_colors.json')
                    .then(response => response.json())
                    .then(colorScales => {
                        const colormapSelect = document.getElementById('colormap');
                        
                        // Add scientific color maps to dropdown
                        Object.keys(colorScales).forEach(cmapName => {
                            const option = document.createElement('option');
                            option.value = cmapName;
                            option.textContent = `Scientific: ${cmapName}`;
                            colormapSelect.appendChild(option);
                        });

                        // Add regular color maps to dropdown
                        const regularColormaps = ['Jet', 'Rainbow', 'Inferno', 'Viridis', 'Cividis']; // Regular colormaps
                        regularColormaps.forEach(cmap => {
                            const option = document.createElement('option');
                            option.value = cmap;
                            option.textContent = `Regular: ${cmap}`;
                            colormapSelect.appendChild(option);
                        });

                        // Update colormap dynamically
                        colormapSelect.onchange = function () {
                            const selectedColormap = this.value;

                            if (colorScales[selectedColormap]) {
                                // Scientific colormap
                                const colorscale = colorScales[selectedColormap];
                                Plotly.restyle('plot', { colorscale: [colorscale] });
                            } else {
                                // Regular colormap
                                Plotly.restyle('plot', { colorscale: [selectedColormap] });
                            }
                        };
                    })
                    .catch(error => console.error('Error loading scientific color scales:', error));
            })
            .catch(error => console.error('Error loading density data:', error));
    </script>
</body>
</html>
